---
title: processing raw data to package data
---

```{r include=FALSE}
assertthat::assert_that(
    knitr::current_input() %>% paste0('R-raw/', .) %>% file.exists(),
    msg = 'Please set knitr root directory to project directory! You may try running `rmarkdown::render("data-raw/data.Rmd")` at project directory or clicking `Knit` button on the top of this document in RStudio.'
)
```

```{r clean, include=FALSE}
dir('data', full.names = T) %>% file.remove()
rm(list = ls(envir = globalenv(), all = T))
```

Process you raw data here.

```{r}
suggest_refer_tran_id <- c(
    'ENST00000408438.1|MIR1228-201|73',
    'ENST00000385271.1|MIR16-1-201|89',
    'ENST00000607334.3|MIR15A-201|83',
    'ENST00000385059.1|MIR451A-201|72',
    'ENST00000362134.1|MIR21-201|72',
    'ENST00000385245.1|MIR23A-201|73',
    'ENST00000385045.1|MIR15B-201|98',
    'ENST00000362117.1|MIR16-2-201|81',
    'ENST00000384832.1|MIR23B-201|97',
    'ENST00000579846.3|MIR23C-201|100'
)
usethis::use_data(suggest_refer_tran_id, overwrite = TRUE)

reference_transcript <- tibble::tibble(id = reference_transcript_id) %>% 
	dplyr::mutate(name = stringr::str_remove(id, '^[^\\|]+\\|')) %>%
	dplyr::mutate(name = stringr::str_remove(name, '\\|[^\\|]+$')) %>% 
	dplyr::mutate(name = stringr::str_remove(name, '-\\d+$'))

rna_type <-  'inst/extdata/all.txt' %>% readr::read_tsv() %>% 
	dplyr::select('transcript_id', 'transcript_type')
usethis::use_data(rna_type, overwrite = TRUE)
```


```{r}
mat_raw <- 'inst/extdata/scirep_sequential_qc.txt' %>% rexseek::read_mat()
mat <- mat_raw %>% rexseek::filter_low()
mat1000 <- mat_raw %>% {.[sample(nrow(.), 1000), ]*10}

usethis::use_data(mat1000, overwrite = TRUE)
```


```{r}
sample_class <- 'inst/extdata/scirep_classes.txt' %>% readr::read_csv(T, 'cc')

usethis::use_data(sample_class, overwrite = TRUE)
```

```{r rebuild, include=FALSE}
system('R CMD INSTALL --no-multiarch --with-keep.source .')
devtools::reload();
devtools::test();
```




